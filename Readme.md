# Scrapper of Space

![Image_Sequence_011_0000](https://github.com/Paladin-Danse/Project_LSD/assets/24542378/52976c3c-eb55-4f7f-af6e-08ccef888581)

## 프로젝트 소개

* 프로젝트 명 : Scrapper Of Space(SOS)

* 개발 기간 : 2024.03.06. ~ 2024.05.01.

* 참여 인원 및 담당 파트

<br>

> 팀장 | 이승준

| 담당 작업 | 플레이어와 총기 조작, 인벤토리 |
| --- | --- |
| 연락처 | 010-5484-0387 |
| 이메일 | dltmdwns1026@gmail.com |
| Github | https://github.com/Paladin-Danse |

> 팀원 | 유호진

| 담당 작업 | 스탯(캐릭터, 무기), 버프/디버프, 오브젝트 풀링, 씬 로딩, 씬 매니저, UI컨트롤러, HUD, 리팩토링(데이터와 UI 분리) |
| --- | --- |
| 연락처 | 010-6471-0062 |
| 이메일 | siryu2409@gmail.com |
| Github | https://github.com/siryu2409 |

> 팀원 | 채호선

| 담당 작업 | 맵, 적 유닛, 임무, UI 디자인 및 사운드, 컷신 연출 |
| --- | --- |
| 연락처 | 010-3134-4832 |
| 이메일 | fmms2481@naver.com |
| Github | https://github.com/fmmscogh |

> 팀원 | 정지엽

| 담당 작업 | 인트로 씬 배경, 사운드 설정 |
| --- | --- |
| 연락처 | 010-7503-0500 |
| 이메일 | wwd_@naver.com |
| Github | https://github.com/wwd2022 |

<br>

[플레이 영상]

* 게임 소개
Scrapper Of Space(SOS)는 1인칭 시점의 3D 루트슈터 게임이며, 플레이어가 우주 해적이 되어 우주를 떠돌며 임무를 받아 해결하는 게임입니다.

* 조작

이동 : W,A,S,D  
발사 : 좌클릭  
총기 변경 : 휠다운  
상호 작용 : E  
인벤토리 : TAB  
달리기 : LShift  
설정 열기 : Esc  

* 주요 특징

아직 다양한 무기와 스킬이 개발되지 않아 루트 슈터 장르 특유의 자기만의 무기와 스킬셋으로 만드는 자기만의 플레이 스타일을 즐길 수는 없지만, 다양한 적들과 한정된 자원(탄약)으로 싸우는 재미가 있습니다.

<details> 
<summary>배경 이야기</summary>
찬란했던 인류의 문명이 피고 지기를 3번을 반복하고 난 뒤 
여러 과학 기술의 격차가 뒤죽박죽 벌어져버린 세상

수많은 은하를 지배하고있는 제국 외곽의 작은 사막 행성에서
아름답기로 소문난 여자와 성실한 남자 밑에서 사내아이 그로닉이 태어났다.

그로닉이 7살이 되던 해 어느 날 도시를 다스리던 영주의 아들이 마을에 내려와 시찰을 돌며 행패를 부렸다.
그 옆을 지나가던 사람들중에 도시에서 아름답기로 소문난 그로닉의 어머니가 영주의 아들의 눈에 띄었다.

영주의 아들은 곧 바로 그로닉의 어머니의 손목을 낚아채 근처 여관으로 향했고 그것을 막아서려던 그로닉의 아버지는 영주의 호위병사들에게 흠씬 두들겨 맞아야만 했다.
결국 이웃에게 부축받아 집에돌아온 그로닉의 아버지는 밤늦게 엉망이된 옷을 입고 돌아온 그로닉의 어머니를 보며 서로 숨죽여 울부짖었다.

그 후 그로닉의 아버지가 두들겨 맞은 후유증으로 장애를 얻고 더 이상 일을 하지 못해서 돈을 벌어올 수 없게 되자 그로닉의 어머니가 잡일을 하게된다.
이에 자신의 처지를 비관한 그로닉의 아버지는 어느 날 뒷산에서 목을메서 자살하게된다.

그로닉의 어머니 또한 삶을 포기하고 싶었지만 자식을 놔두고 그럴순 없었기에 삶을 이어가던 중 자신이 영주 아들의 자식을 임신하였다는 것을 알게되었다.

이 사실로 영주에게 돈을 받아보려 영주의 집에 찾아가 영주 아들의 자식을 임신했다고 말한 그로닉의 어머니는 도리어 거짓을 일삼는 더러운년이라며 영주의 하인들에게 끌려가 매타작을 당하고 영주의 성에 있는 지하 감옥에 갇힌다.

그와중에도 영주의 아들은 영주 몰래 지하 감옥에 들러 그로닉의 어머니에게 치근덕 거리다 혀를 물어 뜯기게 되고 이에 격분한 영주의 아들은 병사들을 시켜 그로닉의 어머니를 죽여버린다.

또 그로닉의 어머니에게 아들이 있다는게 생각난 영주의 아들은 혼자 남아있던 그로닉까지 납치해서 자신의 가문이 운영하는 광산에 노예로 넘겨버린다.

항상 어느 때든 틈을 노려 도망치려다 잡히고 매질을 당하는 삶을 10년을 살아온 그로닉은 어느 날 갑자기 광산 노예들의 폭동이 일어났고 그 틈을 타서 전에 알아둔 우주비행선이 있는 곳을 찾아가 혼란을 틈타 탈취해서 행성을 빠져나간다.

그러나 꽤나 빠르게 이것을 알아챈 영주가 추격대를 보내고 추격대의 공격에서 도망치던 그로닉은 추격대의 공격에 우주비행선의 한쪽이 파손되어 정신을 잃는다.
파손된 우주비행선을 회수하려던 추격대는 갑자기 나타난 우주해적들을 보고 부리나케 도망치고 우주해적이 그로닉의 우주비행선을 회수하던중 정신을 잃고 쓰러져있던 그로닉을 발견하게된다.

우주해적 선장에게 거둬지게된 그로닉은 해적선 내부의 잡일과 전투술을 배우며 해적질에 동참해서 점점 우주해적의 일원으로 자리잡게된다.
그렇게 점차 실력과 공을 쌓아 인정받게된 그로닉은 8번대까지밖에 없었던 우주해적선에 9번대의 대장이 되고 개인적으로 작전을 통솔할 수 있는 권한을 부여받아서 드디어 부모의 원수를 갚을 수 있는 기회를 얻게된다.
</details>


## 프로젝트 결과

개발 기간 : 2024.03.06 ~ 2024.05.01

초기 계획

- 3/6 : 기획 및 MVP 구현
- 3/25 : 중간발표
- 3/26 ~ 04/23 : 추가 기능 구현 및 버그 수정
- 04/24 ~ 04/28 : 유저 테스트 진행
- 04/25 ~ 04/30 : 유저 피드백 검토 및 반영, 버그 수정
- 5/1 : 최종 발표

진행 상황

[x]  3/6 : 기획 및 MVP 구현  
[x]  3/25 : 중간발표  
[x]  3/26 ~ 04/23 : 추가 기능 구현 및 버그 수정  
[X]  04/24 ~ 04/28 : 유저 테스트 진행 중  
[X]  04/25 ~ 04/30 : 유저 피드백 검토 및 반영, 버그 수정  
[ ]  5/1 : 최종 발표  

### 적용한 기술 사항

<details> <summary> FSM </summary>
    <details> <summary> Player </summary>
    사용 이유 : 장착한 무기도 함께 사용하였으며, 다양한 상황에 맞춰 애니메이션을 구동하고 해당 상태에서만 코드가 실행되도록 제어와 관리의 목적으로 사용하였습니다. <br />
    <img alt="" src="https://github.com/Paladin-Danse/Project_LSD/assets/24542378/cfe9b788-81bd-4440-89ef-1cb91edd9dd6"/> 
    </details>
    <details> <summary> Enemy </summary>
    사용 이유 : 적 유닛의 행동 패턴을 각각의 개별적인 상태로 나누어 조건에 따라 상태가 실행될 수 있도록 하는게 AI를 구현함에 있어서 더 직관적이고 용이하다고 판단하였습니다. <br />
    <img alt="" src="https://github.com/Paladin-Danse/Project_LSD/assets/24542378/1caaa53d-67b0-460d-b85e-002354c7aeba"/> 
    </details>
</details>
<details> <summary> ObjectPooling </summary>
사용 이유 <br />
    - 슈팅 장르의 특성상 탄환과 같은 오브젝트들의 잦은 생성과 파괴가 일어나는데, 이 과정에서 생성되는 가비지들을 최소화하여 쾌적한 게임 환경을 제공하기 위해 도입하였습니다. <br />
<img alt="" src="https://github.com/Paladin-Danse/Project_LSD/assets/24542378/427d2595-a523-4572-91ca-3d653512d65b"/> 
</details>
<details> <summary> Singleton </summary>
사용 이유 <br />
    - 데이터의 중복 생성을 방지하고, 데이터의 관리, 공유, 접근을 편리하게 만들기 위해 사용하였습니다. <br />
    QuestManager, QuestTracker, SoundManager, Player, SceneLoader, GameManager 등의 클래스에 싱글톤을 사용하고 있습니다. <br />
</details>
<details> <summary> ScriptableObject </summary>
도입 배경 <br />
- 유니티 내부에서 사용될 초기 값들을 관리하기 용이하고, ScriptableObject ↔ JSON ↔ Excel로 이어지는 데이터 관리의 유용성때문에 사용하였습니다. <br />
플레이어 스탯, 무기 스탯, 적 유닛 스탯, 던전, 퀘스트, 인벤토리 등이 SO를 사용하여 관리되고 있으며, 특히 Quest는 Excel → JSON → SO를 통해 퀘스트 목록을 관리하고 있습니다. <br />
</details>
<details> <summary> TimeLine & Cinemachine </summary>
    사용 이유 : 던전 입장시 컷씬 연출을 위해 사용하였습니다. <br />
여러 타입의 트랙을 사용하고 각각의 트랙의 클립들을 블렌드하여 복잡한 효과들을 한번의 시퀸스로 나타내는 애니메이션 시퀸스를 만들어낼 수 있었습니다. <br />
<video alt="" src="https://github.com/Paladin-Danse/Project_LSD/assets/24542378/c4d1aa15-b4c7-49f1-8e48-665a1e946b95"/> <br />
    TimeLine의 시각적으로 직관적인 점때문에 컷씬을 편집함에 있어서 편리했고 Cinemachine의 가상 카메라를 사용하여 연출에 따라 시점을 옮겨다닐 수 있게 할 수 있었습니다. <br />
<img alt="" src="https://github.com/Paladin-Danse/Project_LSD/assets/24542378/e945e732-4283-43d8-b996-9cf5099a44db"/> 
</details>
<details> <summary> 던전 최적화 </summary>
원형 콜라이더를 사용하여 OnTriggerEnter로 센서처럼 사용해 플레이어가 콜라이더 내부로 진입하면 적 유닛의 주요 스크립트가 enabled = true;가 되어 기능이 가동하고 콜라이더 밖으로 플레이어가 나가면 enabled = false;가 되어 코드 사용이 멈추게 되서 플레이어와 전투를 치루는 적 유닛의 코드만 활성화되게 만들어 동시에 사용되는 메모리의 양을 줄였습니다. <br />
<code>
EnemyStateMachine enemyStateMachine;
public Enemy meleeEnemy;    
private void OnTriggerEnter(Collider other)
{
    if (other.gameObject.layer == LayerMask.NameToLayer("Player"))
    {
        if (other.TryGetComponent<Health>(out meleeEnemy.stateMachine.Target))
        {
            meleeEnemy.enabled = true;
        }                        
    }
}

private void OnTriggerExit(Collider other)
{
    if (other.gameObject.layer == LayerMask.NameToLayer("Player"))
    {
        if (other.TryGetComponent<Health>(out meleeEnemy.stateMachine.Target))
        {
            meleeEnemy.enabled = false;
        }
    }
}
</code>
</details>
<details> <summary> Stat 및 StatHandler </summary>
    캐릭터와 무기의 스텟을 ScriptableObject를 통해 초기화하고, 게임 진행 중에 변화하는 스탯을 반영하도록 하였습니다. <br />
    또한, Enum을 이용해 중첩되는 스텟에 가할 연산을 정하고, Flag를 이용하여 연산할 스탯을 제한 할 수 있도록 하였습니다. <br />
<img alt="" src="https://github.com/Paladin-Danse/Project_LSD/assets/24542378/d7ef2814-3203-4479-a46b-68d5d13610b8"/> <br />
    StatHandler 클래스들은 이러한 스탯들의 목록을 가지고 중첩이 반영된 최신 스탯을 유지합니다. <br />
<img alt="" src="https://github.com/Paladin-Danse/Project_LSD/assets/24542378/87fb2f71-785e-44e2-be33-00f1a3d5d93b"/> <br />
</details>

### 트러블 슈팅

<details> <summary> WaitForSeconds 캐싱 문제 </summary>
    <a href="https://www.notion.so/WaitForSeconds-7ae6f7081c4344f4825b55ce68765888?pvs=21">WaitForSeconds 최적화 보고서</a>
</details>
<details> <summary> 적 보스 유닛의 몸체가 플레이어 방향으로 숙여지지 않는 문제 </summary>
    문제점 : 적 보스 유닛의 몸체가 플레이어 방향으로 숙여지지 않아 적 보스 유닛의 공격이 투사체로 일직선으로 나가서 플레이어에게 향하지 않는 문제점이 있었습니다. <br />
    분석 : 상태머신에서 적 보스 유닛과 플레이어의 거리를 체크해서 상태를 변경하는 코드가 Update에 있고 적 보스 유닛이 플레이어가 있는 방향으로 몸체를 숙이게하는 코드도 Update에 있어서 상태에 맞는 애니메이션을 실행하는 부분만 실행되고 몸체를 숙이는건 실행되지 않는것 같았습니다. <br />
    해결방법 : 플레이어가 있는 방향으로 몸체를 숙이게 하는 코드를 LateUpdate에 넣어서 사용하여 Update 다음에 실행되게하여 정상적으로 작동하였습니다. <br />
    <code>
    void LateUpdate()
    {
        if(target != null)
        {
            LookTarget();
        }        
    }
    public void LookTarget()
    {        
        float distance = Vector3.Distance(transform.position, target.position);
        float nor = Mathf.InverseLerp(minD, maxD, distance);
        float targetR = Mathf.Lerp(minR, maxR, nor);        
        transform.Rotate(0f, targetR, 0f);              
    }
    </code>
</details>
    
<details> <summary> 인벤토리 내부에서 무기를 장착할 수 없는 문제 </summary>
    - 문제점 : 무기를 인벤토리 내 아이템으로 전환하는데 필요한 정보는 무기 안에서 전부 꺼내올 수 있게 설계되었지만, 반대로 아이템 슬롯이 가지는 아이템 데이터엔 무기의 정보를 모두 가져오기엔 데이터가 많아 모든 슬롯에 무기의 데이터를 가지게 하는 것이 망설여져 진행이 막히는 일이 있었습니다. <br />
    해결 : 무기에 필요한 전부를 들 수 없다면 무기가 가지고 있는 스탯만 가져가고 무기를 장착할 때 해당 무기의 스탯의 정보를 기반으로 활성화할 무기를 On/Off 해주는 것으로 해결하였습니다. <br />
    - 느낀점 : 코드를 설계하는 것이 중요하다는 것이 개인적으로 크게 와 닿은 트러블이었습니다. 처음 코드를 설계하기 전에는 무기를 플레이어에게 모두 집어넣고 활성화만 시켜놓으면 간단하게 해결될 문제라고 생각했습니다만, 개발이 진행되면서 인벤토리를 구상하게 되니 내부에서 데이터를 조작해야 되는 상황이 오게 되자 이미 플레이어가 들고 있는 무기의 데이터를 내부에서 수정하는 방식으로 구현하는 방법밖에 쓸 수 없어 손이 많이 가는 작업이 되었습니다. 만약 다음에 비슷한 작업이 있다면 최소한 플레이어에게 모든 무기를 하위 오브젝트로 달아놓는 방법은 무기마다 스탯이 다르게 적용할 계획이라면 지양해야 될 듯 싶었습니다. <br />
    <img alt="" src="https://github.com/Paladin-Danse/Project_LSD/assets/24542378/93343735-36eb-4aff-9639-8ba18c7a70e2"/>
</details>

### 사용한 도구

#### 게임 개발 도구

![Untitled](https://github.com/Paladin-Danse/Project_LSD/assets/24542378/5d69b582-72fd-4ee8-b58f-767c744d10b0)
![Untitled (1)](https://github.com/Paladin-Danse/Project_LSD/assets/24542378/1c1c5cb2-be0b-4ca2-aec8-a955dfaebc6b)
![Untitled (2)](https://github.com/Paladin-Danse/Project_LSD/assets/24542378/b6dbb80f-17dd-49b5-b00f-bfbbe949fcc2)

개발 엔진으로는 Unity, 언어는 C#을 사용하였으며, VisualStudio로 소스코드 작성 및 디버깅을 하였습니다.

#### 협업 도구

![Untitled (3)](https://github.com/Paladin-Danse/Project_LSD/assets/24542378/695c4f5e-08d0-4f1e-a399-60b2258bef9f)
![Untitled (4)](https://github.com/Paladin-Danse/Project_LSD/assets/24542378/b372454e-7727-4b03-b37b-581ee0387546)
![Untitled (5)](https://github.com/Paladin-Danse/Project_LSD/assets/24542378/a9b27e15-3558-4717-b413-d31fc29f13a6)

<details> <summary> Git </summary>
    Git을 이용하여 소스 코드와 리소스를 관리하였습니다. <br />
    <img alt="" src="https://github.com/Paladin-Danse/Project_LSD/assets/24542378/36b8fa6a-0bcd-403b-a902-2c06ab3c048f"/>
    Main → Dev → Feature로 이어지는 GitFlow를 도입하여 안정적인 버전 관리를 하였고, <br />
    커밋의 제목에는 간단한 컨벤션을 적용하여 서로의 작업을 알기 쉽게 하였습니다. <br />
</details>

<details> <summary> Notion </summary>
    Notion을 이용하여 매일 2회 진행되는 스크럼 문서를 관리하고, <br />
    칸반보드를 만들어 프로젝트의 진척도 및 태스크를 관리하였습니다. <br />
    <img alt="" src="https://github.com/Paladin-Danse/Project_LSD/assets/24542378/0201a5bd-f042-454a-80e9-7467781f9698"/> <br />
    <img alt="" src="https://github.com/Paladin-Danse/Project_LSD/assets/24542378/8efb7472-b384-450a-8c10-4448241cf1b9"/>
</details>

<details> <summary> Slack & Zep </summary>
    Zep을 이용하여 실시간으로 문제 상황을 공유하였으며, 때로는 화면 공유를 통해 함께 문제를 해결하였습니다. 또한, Slack으로 개인 부재 일정을 공유하여 부재 중인 인원에 대해서 대응 할 수 있도록 하였습니다. <br />
    <img alt="" src="https://github.com/Paladin-Danse/Project_LSD/assets/24542378/97c61494-bf36-43d4-aee2-15922ea7f735"/>
</details>

### 클라이언트 구조

* 씬 구성 및 흐름
![image](https://github.com/Paladin-Danse/Project_LSD/assets/24542378/d90894b2-a074-45ee-910f-a7394fdf5d16)
모든 씬들은 로딩씬을 통해 불필요한 데이터들을 정리하고 다음 씬으로 넘어갑니다.

* 게임 주요 Manager 클래스들
![image](https://github.com/Paladin-Danse/Project_LSD/assets/24542378/6f0f69d3-0dac-4c3b-8736-ff7f082d4d48)


### 피드백 및 개선사항

사용자 피드백은 구글폼을 통해 4/24 ~ 4/28에 걸쳐 진행하였으며, 총 8개의 응답을 받았습니다.

<details> <summary>사용자 피드백 데이터 취합 및 결론</summary>
UI 관련

~~SettingUI 닫는 버튼 없음~~

현재 Tab-Esc를 연달아 누르면 계속해서 UI가 쌓임 → 그러다보면 안꺼지는 경우 있음

: UIController 수정 예정

상호작용하는 곳이 잘 알기 어렵다

: 맵 문제와 복합적, PlayerInteract 범위 증가

적 HP 표시

: 조준한 적에 대해서만 HP바 표시?

사운드 관련

부족한 사운드 피드백

: 플레이어 걷는 소리, 피격-타격 소리 추가

중첩시 음량이 커짐

사운드 중첩시 음량 커짐

: 해당 오브젝트의 AudioSource의 음량값을 줄임 

총기의 기본 음량이 너무 큼

: 기본 음량이 너무 큰 것들은 어떻게 수정? → 기준 사운드 한 개 두고 사운드 에셋 자체 수정?

비주얼 관련

보스 이펙트가 너무 강해서 시야를 가림

: 현재 조금 수정함

게임 플레이 관련

터렛이 너무 강한 반면 보상이 없다

: 터렛은 무조건 무언가를 떨구게 수정? (ex. 총알 박스 여러 개)

적 유닛이 총을 맞고 있는지, 나도 총을 맞았는지 피드백이 없다

: 적 유닛이 조금이나마 밀려나게 or 피격 이펙트/사운드 추가, 플레이어 피격 이펙트 추가

총기 이펙트 부재

: 이펙트 추가 하는 걸로

보스 타게팅 버그, 보스 스킬 버그(실드 그냥 몸 비비면 안에 들어감)
: 차차 수정 하는 것으로

맵뚫(특히 광산)
: 광산 삭제, terrain collider 삼중으로

총알이 다 떨어진 경우에 총알 수급 수단이 없음

: 박스 그냥 상호작용으로도 파괴 가능하게 하고, 양 늘리고, 마켓 추가?

너무 멀리서 쏘는 경우에 몬스터가 반응이 없음

: 멀리서 피격 당한 경우 바로 플레이어 추격하게?

무적존의 존재

: 맵 수정 필요

보스가 보스인지 와닿지 않았다

: 보스방 진입시 컷씬?

총알을 허공에 쏴도 적이 죽거나 조준한 적이 아닌 다른 적이 죽는다

: 수정 중

반동이 너무 심하다(초탄 반동이 너무 강하다)

: 반동 비주얼을 조금 부드럽게 가능?

달리는 중에 장전이 안되는게 불편하다

: 추후 달리는 중에 장전 허용, 발사 허용(발사시 Spread 대폭 증가)?

공중에서 조작이 안되는게 불편하다(납득 가능한 사람도 있음)

: 공중에서 조작 가능하게 하는 대신에 조금만 움직이게?

임무 목표를 잘 모르겠다

: 다이얼로그를 나중에 추가 해야 할 것 같습니다

맵뚫 해결을 위해 플레이어 움직임 수정도 필요
</details>

<details> <summary> 피드백 반영 </summary>
총알 발사 수정 -> 총 발사를 위해 사용한 Raycast가 Enemy의 감지 Collider에 부딪혀 엉뚱한 곳으로 발사되는 경우가 빈번했음

터렛 드랍, 폭발음 음량 수정

던전 입장 상호작용 수정 -> 플레이어의 상호작용을 Raycast가 아닌 Collider로 변경

플레이어 피격 이펙트 추가

SettingUI 닫기 버튼 추가, Exit 아이콘 문으로 교체

무기 스왑시 무기 데미지가 중첩되던 버그 수정

적 타격 이펙트 및 총 발사 이펙트 추가, 일반 몹 피격시 넉백

</details>
